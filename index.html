<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ§¸ è§’è½é›œè²¨èˆ– POS</title>
    <style>
        :root { --main-brown: #b0a496; --bg-cream: #fcf8f5; --accent-brown: #8c7b6c; }
        body { font-family: sans-serif; background: var(--bg-cream); margin: 0; display: flex; flex-direction: column; height: 100vh; color: #5d5246; overflow: hidden; }
        header { background: var(--main-brown); color: white; padding: 15px; text-align: center; font-size: 1.5em; font-weight: bold; flex-shrink: 0; }
        .nav-bar { background: #e8e0d9; padding: 12px; display: flex; gap: 10px; overflow-x: auto; border-bottom: 2px solid #d1c7bc; flex-shrink: 0; }
        .nav-btn { background: white; border: 1px solid #d1c7bc; padding: 10px 20px; border-radius: 25px; white-space: nowrap; cursor: pointer; font-weight: bold; font-size: 1em; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .main-content { display: flex; flex: 1; overflow: hidden; padding: 15px; gap: 15px; }
        .item-area { flex: 2; overflow-y: auto; background: white; border-radius: 15px; padding: 20px; border: 2px solid #e8e0d9; }
        .cat-title { background: #fdf5f0; padding: 10px 20px; border-radius: 25px; margin: 20px 0 15px; font-weight: bold; font-size: 1.2em; border-left: 8px solid var(--main-brown); }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
        .p-btn { background: white; border: 1px solid #f0e6dd; border-radius: 12px; padding: 12px 8px; text-align: center; cursor: pointer; box-shadow: 3px 3px 0 #e8e0d9; min-height: 80px; display: flex; flex-direction: column; justify-content: center; }
        .p-btn:active { transform: scale(0.95); background: #faf7f4; }
        .p-name { font-size: 0.9em; font-weight: bold; margin-bottom: 4px; line-height: 1.2; color: #4a4238; }
        .p-price { color: #c2966d; font-size: 1em; font-weight: bold; }
        .checkout-area { flex: 1; display: flex; flex-direction: column; gap: 15px; min-width: 350px; overflow-y: auto; }
        .card { background: white; border-radius: 15px; padding: 18px; border: 2px solid #e8e0d9; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        #cart-list { max-height: 180px; overflow-y: auto; border-bottom: 2px dashed #e8e0d9; margin-bottom: 12px; }
        .total-display { font-size: 2.8em; font-weight: bold; color: #d9534f; text-align: right; margin: 5px 0; }
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; font-weight: bold; }
        .change-row { color: #2e7d32; border-top: 1px solid #eee; padding-top: 8px; margin-top: 8px; }
        input { width: 100px; padding: 8px; border: 2px solid #e8e0d9; border-radius: 10px; text-align: center; font-size: 1.1em; color: #5d5246; }
        input#received { color: #d9534f; border-color: #b0a496; }
        .m-btn { flex: 1; padding: 15px; border-radius: 12px; border: 2px solid #d1c7bc; background: white; font-weight: bold; cursor: pointer; text-align: center; }
        .m-btn.active { background: var(--accent-brown); color: white; border-color: var(--accent-brown); }
        .done-btn { background: #6b8e23; color: white; border: none; width: 100%; padding: 18px; border-radius: 15px; font-size: 1.4em; font-weight: bold; cursor: pointer; }
        .date-group { margin-top: 15px; border-top: 2px solid #eee; padding-top: 10px; }
        .date-header { background: #8c7b6c; color: white; padding: 5px 12px; border-radius: 8px; font-size: 0.9em; display: flex; justify-content: space-between; margin-bottom: 8px; }
        .log-item { background: #fdfaf8; border-radius: 8px; padding: 10px; margin-bottom: 6px; border-left: 4px solid #b0a496; font-size: 0.85em; }
        .log-details { color: #777; margin-top: 3px; font-size: 0.9em; line-height: 1.3; }
    </style>
</head>
<body>
    <header>ğŸ§¸ è§’è½é›œè²¨èˆ– POS</header>
    <div class="nav-bar" id="navbar"></div>
    <div class="main-content">
        <div class="item-area" id="item-area"></div>
        <div class="checkout-area">
            <div class="card">
                <div id="cart-list"></div>
                <div class="total-display">$<span id="final-total">0</span></div>
            </div>
            <div class="card">
                <div class="row"><span>æŠ˜æ‰£é‡‘é¡:</span><input type="number" id="discount" placeholder="0" oninput="calc()"></div>
                <div class="row"><span>å¯¦æ”¶é‡‘é¡:</span><input type="number" id="received" placeholder="è¼¸å…¥æ”¶æ¬¾" oninput="checkChange()"></div>
                <div class="row change-row"><span>æ‰¾é›¶é‡‘é¡:</span><span style="font-size:1.5em;" id="change-amount">$0</span></div>
                
                <div class="pay-method" style="display:flex; gap:10px; margin:15px 0;">
                    <div class="m-btn active" id="btn-cash" onclick="setPay('ç¾é‡‘')">ğŸ’µ ç¾é‡‘</div>
                    <div class="m-btn" id="btn-card" onclick="setPay('é›»æ”¯')">ğŸ“± é›»æ”¯</div>
                </div>
                <button class="done-btn" onclick="submit()">âœ¨ å®Œæˆçµå¸³</button>
            </div>
            <div class="card log-area">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <strong>ğŸ“ æ­·å²æˆäº¤ç´€éŒ„</strong>
                    <button onclick="if(confirm('æ¸…ç©ºå°‡åˆªé™¤æ‰€æœ‰ç´€éŒ„ï¼Ÿ')){orderHistory=[]; localStorage.removeItem('pos_history_v3'); updateLogDisplay();}" style="font-size:0.7em;">å…¨éƒ¨æ¸…ç©º</button>
                </div>
                <div id="order-log"></div>
            </div>
        </div>
    </div>

<script>
    let payType = 'ç¾é‡‘', cart = [];
    let orderHistory = JSON.parse(localStorage.getItem('pos_history_v3') || '[]');

    // (æ­¤è™•ä¿ç•™åŸæœ¬çš„ inventory è³‡æ–™ä¸è®Š...)
    const inventory = [
        { cat: "A åŒ…åŒ…", items: [{n:"A01 é‡ç¹”(é»ƒé¬±é‡‘é¦™)",p:79},{n:"A02 é‡ç¹”(ç±³å°ç™½ç‹—)",p:79},{n:"A03 æ³¢é»å°ç‹—åŒ–å¦åŒ…",p:99},{n:"A04 çšºè‚©åŒ…(éŠ€)",p:199},{n:"A05 çšºè‚©åŒ…(è—)",p:199},{n:"A06 ä¿é½¡çƒåŒ…(å’–)",p:249},{n:"A07 è±¹ç´‹å°å»¢åŒ…(å’–)",p:149},{n:"A08 çšºè‚©åŒ…(éŠ€æ–œèƒ¯)",p:199},{n:"A09 çšºè‚©åŒ…(ç™½æ–œèƒ¯)",p:199},{n:"A10 æœˆç‰™è…‹ä¸‹(é»‘)",p:199},{n:"A11 æœˆç‰™è…‹ä¸‹(ç™½)",p:199},{n:"A12 é›²æœµè¿·ä½ (ç™½)",p:139},{n:"A13 é›²æœµè¿·ä½ (é»‘)",p:139},{n:"A14 äº®çš®æ–œèƒ¯(é»‘)",p:249},{n:"A15 æŠ˜ç–ŠåŒ–å¦åŒ…(ç‹—)",p:99},{n:"A16 å¡å…¶è±¹ç´‹å°æ–¹åŒ…",p:139},{n:"A17 ç·¨ç¹”æœˆç‰™(ç²‰ç´…)",p:199},{n:"A18 è·³è‰²æœˆç‰™(ç±³ç™½)",p:199},{n:"A19 Y2KéŠæ¢é›™è‚©åŒ…",p:199},{n:"A20 JKæ—¥ç³»éƒµå·®åŒ…",p:289},{n:"A21 æ¼†çš®æ³•æ£(é»‘)",p:199},{n:"A22 çç é›™éŠ(ç²‰)",p:249},{n:"A23 çç é›™éŠ(ç™½)",p:249},{n:"A24 æ–¹å½¢è…‹ä¸‹(é»‘)",p:199},{n:"A25 æ–¹å½¢è…‹ä¸‹(ç´…æ£•)",p:199},{n:"A26 å¤§å®¹é‡ä¿é½¡çƒ",p:289},{n:"A27 è•¾çµ²å¾ŒèƒŒ(é»‘)",p:199},{n:"A28 è•¾çµ²å¾ŒèƒŒ(ç²‰)",p:199},{n:"A29 è¤¶çšºé›²æœµåŒ…",p:199},{n:"A30 é‡ç¹”(çœ¼é¡ç‹—)",p:139},{n:"A31 é‡ç¹”(ç´…æ ¼ç‹—)",p:139}] },
        { cat: "B å°ç‰©", items: [{n:"B01 è¿·ä½ ç£å¸å°æª¯ç‡ˆ(è—è‰²)",p:79},{n:"B02 è¿·ä½ ç£å¸å°æª¯ç‡ˆ(ç¶ è‰²)",p:79},{n:"B03 ç« é­šæš–å…‰ç‡ˆ(è—è‰²)",p:89},{n:"B04 ç« é­šæš–å…‰ç‡ˆ(é»ƒè‰²)",p:89},{n:"B05 é¬±é‡‘é¦™å°å£å¤¾(é»ƒ)",p:69},{n:"B06 é¬±é‡‘é¦™å°å£å¤¾(ç²‰)",p:69},{n:"B07 ä¸ƒå±¤æ¼¢å ¡å¡‘è† ç›¤",p:129},{n:"B08 é»ƒè‰²çœ¼ç›åŒ–å¦é¡",p:99},{n:"B09 ç²‰è‰²çœ¼ç›åŒ–å¦é¡",p:99},{n:"B10 ç„¡æ¯’è»Ÿé ­ä¸™çƒ¯é¦¬å…‹ç­†(12è‰²)",p:99},{n:"B11 ç„¡æ¯’è»Ÿé ­ä¸™çƒ¯é¦¬å…‹ç­†(48è‰²)",p:259},{n:"B12 ä¾¿åˆ©åº—å­˜éŒ¢ç½",p:159},{n:"B13 å»£è§’é¡æ‰‹æ©Ÿæ”¯æ¶",p:99},{n:"B14 å°éº¥éº¥è€³æ©Ÿå¸½",p:89},{n:"B15 å¤šå·´èƒºè¨ˆç®—æ©Ÿ(é»ƒ)",p:99},{n:"B15 å¤šå·´èƒºè¨ˆç®—æ©Ÿ(ç´«)",p:99},{n:"B17 å¤šå·´èƒºè¨ˆç®—æ©Ÿ(ç™½)",p:99},{n:"B18 é›²æœµé¡",p:49},{n:"B19 é…ªæ¢¨é€ å‹é¦™æ°›è Ÿç‡­",p:99},{n:"B20 æ©˜å­é€ å‹é¦™æ°›è Ÿç‡­",p:99},{n:"B21 è–èª•æ¨¹é¦™æ°›è Ÿç‡­(ç™½)",p:99},{n:"B22 è–èª•æ¨¹é¦™æ°›è Ÿç‡­(ç¶ )",p:99},{n:"B23 ææ€ªæ°´æœé¦™æ°›è Ÿç‡­(æŸ¿å­)",p:99},{n:"B24 ææ€ªæ°´æœé¦™æ°›è Ÿç‡­(å±±ç«¹)",p:99},{n:"B25 æ˜Ÿæ˜Ÿäººæ‰‹æ©Ÿæ°£å›Š(æ§æ˜Ÿ)",p:59},{n:"B26 æ˜Ÿæ˜Ÿäººæ‰‹æ©Ÿæ°£å›Š(çœ‹æ˜Ÿ)",p:59},{n:"B27 ç„¡å°¾ç†Šç£å¸æ‰‹æ©Ÿæ°£å›Š",p:79},{n:"B28 æ‰‹ææŠ±æ•æ¯¯(å¤¾å¿ƒé¤…ä¹¾)",p:249},{n:"B29 æ‰‹ææŠ±æ•æ¯¯(å·§å…‹åŠ›é¤…ä¹¾)",p:249},{n:"B30 èƒ¡è˜¿è””éŒ„éŸ³ç­†",p:69},{n:"B31 å¯é Œæ›å‹¾",p:99}] },
        { cat: "C æ‰‹å·¾", items: [{n:"C01 é›¨å‚˜æ“¦æ‰‹å·¾",p:79},{n:"C02 ç´…è‰²è˜‘è‡æ‰‹å·¾",p:79},{n:"C03 è—è‰²å¸½å­å°ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C04 éº¥ç•¶è²“æ“¦æ‰‹å·¾",p:99},{n:"C05 æµ·æ˜Ÿæ“¦æ‰‹å·¾",p:99},{n:"C06 æ°´æ¯æ“¦æ‰‹å·¾",p:99},{n:"C07 åŠ å¤§å¯æ„›å°ç‹—æ“¦æ‰‹å·¾",p:129},{n:"C08 åŠ å¤§å¯æ„›å°ç†Šæ“¦æ‰‹å·¾",p:129},{n:"C09 åŠ å¤§å¯æ„›å°è±¬æ“¦æ‰‹å·¾",p:129},{n:"C10 å’–å•¡å°ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C11 éºµåŒ…ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C12 è¢‹å­ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C13 èƒŒåŒ…ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C14 ç·šæ¢ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C15 æ˜Ÿæ˜Ÿäººæ“¦æ‰‹å·¾",p:99},{n:"C16 æ´‹è”¥å°ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C17 æ©˜å­å°ç‹—æ“¦æ‰‹å·¾",p:99},{n:"C18 åèˆŒé ­ç²‰ç´…ç‹—",p:99},{n:"C19 å¸½å­é•·è€³ç‹—",p:99}] },
        { cat: "D é«®é£¾", items: [{n:"D01 ç£¨ç ‚æ¨¹è„‚ç„¡ç—•å¤¾ä¸€å°(é»‘)",p:49},{n:"D02 ç£¨ç ‚æ¨¹è„‚ç„¡ç—•å¤¾ä¸€å°(ç™½)",p:49},{n:"D03 æ³¢ç´‹å¥¶ç³–é¯Šé­šå¤¾",p:69},{n:"D04 èŠ±é‚Šå°é«®åœˆ(é»‘)",p:29},{n:"D05 å¸ƒé¢è±¹ç´‹ç„¡ç—•å¤¾ä¸€å°",p:69},{n:"D06 è—è‰²æ ¼å­æ«»æ¡ƒèŠ±æœµåœˆ",p:79},{n:"D07 è—è‰²æ«»æ¡ƒæ¢ç´‹å¤§è…¸åœˆ",p:69},{n:"D08 æ¯›æ¯›é¯Šé­šå¤¾(æ·ºå’–)",p:69},{n:"D09 æ¯›æ¯›é¯Šé­šå¤¾(æ·±æ£•)",p:69},{n:"D10 æ„›å¿ƒé‘½ç„¡ç—•å¤¾ä¸€å°",p:69},{n:"D11 çµ¨é¢æ„›å¿ƒæ°´æ»´bbå¤¾ä¸€å°(ç™½)",p:69},{n:"D12 çµ¨é¢æ„›å¿ƒæ°´æ»´bbå¤¾ä¸€å°(è±¹ç´‹)",p:69},{n:"D13 è´è¶çµæ ¼å­å°å¤¾",p:69},{n:"D14 å¸ƒé¢è±¹ç´‹èŠ±è‹åœˆ",p:79},{n:"D15 ç´…é‚Šç°é«®åœˆ",p:79},{n:"D16 è—æ¢ç´‹å¥¶æ²¹èŠ±é‚Šå¤§è…¸åœˆ",p:79},{n:"D17 è±ç´‹å’–è‰²ç„¡ç—•å¤¾ä¸€å°",p:49},{n:"D18 ç™½è‰²æ°´æ³¢ç´‹ç„¡ç—•å¤¾ä¸€å°",p:49},{n:"D19 æ©¢åœ“è´è¶çµå¤¾ä¸€å°(éŠ€)",p:69},{n:"D20 æ©¢åœ“è´è¶çµå¤¾ä¸€å°(ç™½)",p:69},{n:"D21 å¤§è™Ÿè±¹ç´‹é¯Šé­šå¤¾(å’–)",p:69},{n:"D22 é†‹é…¸é‡‘æ¨™ç„¡ç—•å¤¾ä¸€å°(é»‘)",p:79},{n:"D23 é†‹é…¸é‡‘æ¨™ç„¡ç—•å¤¾ä¸€å°(ç™½)",p:79},{n:"D24 çç è´è¶çµç„¡ç—•å¤¾ä¸€å°(éŠ€)",p:79},{n:"D25 éŸ“ç³»é»‘é‚Šæ–œç´‹èŠ±é‚Šåœˆ",p:79},{n:"D26 æ ¼ç´‹æ‰‡å½¢é¯Šé­šå¤¾",p:79},{n:"D27 é»‘é‚Šæ ¼ç´‹æ”¶è…°åœˆ",p:69},{n:"D28 è´è¶çµå’–è‰²æ ¼ç´‹ä¸‰ç¯€åœˆ",p:79},{n:"D29 è´è¶çµæ˜¥å¤©è‰²è•¾çµ²å¤§è…¸åœˆ",p:79},{n:"D30 è´è¶çµæ˜¥å¤©è‰²æ°´æ»´bbå¤¾ä¸€å°",p:69},{n:"D31 å½ˆåŠ›é«®åœˆç½è£(å¥¶å’–)",p:49},{n:"D32 å½ˆåŠ›é«®åœˆç½è£(é»‘è‰²)",p:49},{n:"D33 æ°´æ»´bbå¤¾ä¸€å°(äº”æ¬¾å„äºŒ)",p:82},{n:"D34 å¤§è™Ÿè±¹ç´‹é¯Šé­šå¤¾(ç°)",p:69},{n:"D35 çç æ«»æ¡ƒç„¡ç—•å¤¾ä¸€å°",p:79},{n:"D36 æ ¼ç´‹æ«»æ¡ƒç„¡ç—•å¤¾",p:69},{n:"D37 ç´ å’–+è±¹ç´‹(æ©¢åœ“å¤¾)",p:59},{n:"D38 ç´ å’–+è±¹ç´‹(æ°´æ»´å¤¾)",p:59},{n:"D39 ç´ å’–+è±¹ç´‹(æ„›å¿ƒå¤¾)",p:59}] },
        { cat: "E å¨ƒå¨ƒ", items: [{n:"E01 ç•«å®¶è¥¿é«˜åœ°(å’–)",p:99},{n:"E02 ç•«å®¶è¥¿é«˜åœ°(è—)",p:99},{n:"E03 ç•«å®¶è¥¿é«˜åœ°(ç´…)",p:99},{n:"E04 ç•«å®¶è¥¿é«˜åœ°(ç²‰)",p:99},{n:"E05 ç™½é›ªå…¬ä¸»è£æ‰®è¥¿é«˜åœ°",p:129},{n:"E06 å°é¦™é¢¨è£æ‰®è¥¿é«˜åœ°",p:129},{n:"E07 èƒ¡è˜¿è””è£æ‰®è¥¿é«˜åœ°",p:129},{n:"E08 ææ€ªé•·æ¯›å°æ€ªç¸40cm(ç²‰)",p:199},{n:"E09 ææ€ªé•·æ¯›å°æ€ªç¸40cm(ç´«)",p:199},{n:"E10 éº¥ç•¶è²“å”å”å°æ›ä»¶",p:39},{n:"E11 éº¥ç•¶è²“å°æ›ä»¶",p:39},{n:"E12 åœ“é»å°ç‹—å°æ›ä»¶",p:49},{n:"E13 é¬±é‡‘é¦™æ›ä»¶(é»ƒ)",p:39},{n:"E14 é¬±é‡‘é¦™æ›ä»¶(ç´«)",p:39},{n:"E15 é¬±é‡‘é¦™æ›ä»¶(ç²‰)",p:39},{n:"E16 ææ€ªé†œèŒèŠ±æœµ",p:49},{n:"E17 è£æ‰®æ€•æ´½ç‹—",p:79},{n:"E18 è–‘é¤…äºº",p:39},{n:"E19 è–èª•æ¨¹",p:39},{n:"E20 åƒé‡Œçœ¼å°å¼·",p:39},{n:"E21 å¢¨é¡å°å¼·",p:39},{n:"E22 æŠ½æ‹‰å…”å­(ç´«)",p:129},{n:"E23 æŠ½æ‹‰å…”å­(é»ƒ)",p:129},{n:"E24 ä¸€æ¢ç‹—",p:99}] },
        { cat: "F è¥ªå­åœå·¾", items: [{n:"F01 æ„›å¿ƒå…”å­ä¸­ç­’è¥ª",p:59},{n:"F02 ç´…å¸½å°ç‹—ä¸­ç­’è¥ª",p:59},{n:"F03 ç«‹é«”è²“å’ªè›‹è›‹è¥ª",p:49},{n:"F04 æ³¢é»å°ç‹—é•·çµ±è¥ª",p:49},{n:"F05 EGGåˆºç¹¡éº»èŠ±ä¸­ç­’è¥ª",p:69},{n:"F06 æ¾³çµ¨åˆºç¹¡ä¸­ç­’è¥ª(é ˜çµç‹—)",p:69},{n:"F07 åŠ åšåŠ çµ¨é•·ç­’è¥ª(ä¹ƒç™½è‡˜è…¸ç‹—)",p:59},{n:"F08 æ³¢é»èŠ±é‚Šé•·ç­’å †å †è¥ª(æ·±å’–)",p:69},{n:"F09 æ³¢é»èŠ±é‚Šé•·ç­’å †å †è¥ª(å¥¶æ²¹ç™½)",p:69},{n:"F10 çŠç‘šçµ¨æŒé–€ç‹—ä¸­ç­’è¥ª(ç™½è—)",p:69},{n:"F11 çŠç‘šçµ¨æŒé–€ç‹—ä¸­ç­’è¥ª(ç™½å’–)",p:69},{n:"F12 æ¾³çµ¨è—è‰²è´è¶çµä¸­ç­’è¥ª",p:69},{n:"F13 ç¾Šæ¯›åˆºç¹¡é•·ç­’å †å †è¥ª(å¸½å­ç‹—)",p:69},{n:"F14 é»é»ç´—ä¸­ç­’è¥ª(ç²‰è‰²å…”å­)",p:59},{n:"F15 é»é»ç´—ä¸­ç­’è¥ª(å°ç‹—)",p:59},{n:"F16 é£›æ©Ÿç‹—éš±å½¢è¥ª(æ·±ç°)",p:49},{n:"F17 é£›æ©Ÿç‹—éš±å½¢è¥ª(å¥¶ç™½)",p:49},{n:"F18 é£›æ©Ÿç‹—éš±å½¢è¥ª(ç±³è‰²)",p:49},{n:"F19 è™æ›¸æ¬£é»‘ç±³åœå·¾",p:199},{n:"F20 å››è‰²å’–å•¡è‰²æ ¼å­åœå·¾",p:199},{n:"F21 ä¸€é¡†ç´…è˜‹æœåœå·¾",p:199},{n:"F22 ä»¿ç¾Šæ¯›å’–å•¡è‰²æ ¼å­åœå·¾",p:239},{n:"F23 é˜²ç¾Šæ¯›è±¹ç´‹åœå·¾",p:239}] },
        { cat: "G é¤å…·", items: [{n:"G01 316ä¸é½é‹¼å¸ç®¡å†°å£©æ¯600ml",p:239},{n:"G02 æœ¨æŸ„æ¹¯åŒ™+å‰å­",p:99},{n:"G03 é´¨é´¨æ¹¯åŒ™+å‰å­",p:99},{n:"G04 çç æ¹¯åŒ™+å‰å­",p:99},{n:"G05 å¥¶é…ªæ¹¯åŒ™+å‰å­",p:99},{n:"G06 å¡çš®å·´æ‹‰åˆé‡‘ç­·(å¤ªé™½èŠ±)",p:59},{n:"G07 å¡çš®å·´æ‹‰åˆé‡‘ç­·(é’æ¢¨)",p:59},{n:"G08 å¯å¯è±†8.5å‹è‰å¸½ç›¤",p:239},{n:"G09 6.5å¯¸å¿ƒå‹ç¢—",p:159},{n:"G10 6å‹ç”œå“ç¢Ÿ(å¿«æ¨‚å°ç‹—)",p:139},{n:"G11 5.5å‹æ¨¹å±‹ç¢—",p:189},{n:"G12 8å‹è–¯æ¢ç›¤",p:99},{n:"G13 å°ç‹—é€ å‹ç›¤",p:129},{n:"G14 å°ç†Šé€ å‹ç›¤",p:129},{n:"G15 å¥¶é…ªé†¬æ–™ç¢Ÿ",p:49},{n:"G16 å¯é Œé€ å‹ç›¤",p:189},{n:"G17 æ³•æ£é€ å‹ç›¤",p:189},{n:"G18 åœå·¾å°ç‹—é¦¬å…‹æ¯320MI",p:99},{n:"G19 åœå·¾å°è²“é¦¬å…‹æ¯320MI",p:99},{n:"G20 è¸©æ°´å°ç‹—ç¢Ÿç¢Ÿæ¯",p:129},{n:"G21 è˜‹æœå°ç‹—ç¢Ÿç¢Ÿæ¯",p:129},{n:"G22 å¸ç®¡å¸¶æŸ„é¦¬å…‹æ¯(æ£•è‰²å¥³å­©)",p:159},{n:"G23 å¸ç®¡å¸¶æŸ„é¦¬å…‹æ¯(æ³¢é»å°ç‹—)",p:159},{n:"G24 å¸ç®¡å¸¶æŸ„é¦¬å…‹æ¯(æ³¢é»å¤§è±¡)",p:159},{n:"G25 å¸ç®¡å¸¶æŸ„é¦¬å…‹æ¯(æ£•è‰²ç”·å­©)",p:159},{n:"G26 å¸ç®¡å¸¶æŸ„é¦¬å…‹æ¯(æ³¢é»å°è²“)",p:159},{n:"G27 å¸ç®¡å¸¶æŸ„é¦¬å…‹æ¯(å¡—é´‰å…”å…”)",p:159},{n:"G28 è–„è·ç¶ 9å‹ç é‚Šæ·±ç›¤",p:179},{n:"G29 æµ·æ´¾ç”œå¿ƒ9å‹æ·±ç›¤",p:189},{n:"G30 å°ç¾Š8å‹åœ“ç›¤",p:139},{n:"G31 å°ç‹—é†¬æ–™è¶(æ£•)",p:79},{n:"G32 å°ç‹—é†¬æ–™è¶(ç°)",p:79},{n:"G33 å–æ°´é´¨é†¬æ–™",p:79},{n:"G34 ç…™è—å¾©å¤å’–å•¡æ¯è¶å¥—è£",p:239},{n:"G35 é€æ˜ç›´æ¢ç»ç’ƒå¸ç®¡æ¯(æ£•è‰²æ¯å¥—)",p:99},{n:"G36 é€æ˜ç›´æ¢ç»ç’ƒå¸ç®¡æ¯(ç¶ è‰²æ¯å¥—)",p:99}] },
        { cat: "H ç´…åŒ…", items: [{n:"H1 å¡é€šé¦¬å¹´å¤§å‰5å…¥",p:39},{n:"H2 å¡é€šè²¡æºå»£é€²5å…¥",p:39},{n:"H3 å¡é€šè˜‹æœç¦5å…¥",p:39},{n:"H4 ç‡™é‡‘éº»å°‡é¦¬5å…¥",p:39},{n:"H5 ç‡™é‡‘é¦¬ä¸Šæœ‰éŒ¢5å…¥",p:39},{n:"H6 ç‡™é‡‘æ»¿ç‰ˆé¦¬5å…¥",p:39},{n:"H7 Qç‰ˆé–‹é–‹å¿ƒå¿ƒ5å…¥",p:39},{n:"H8 Qç‰ˆé¦¬åŠ›å…¨é–‹5å…¥",p:39},{n:"H9 Qç‰ˆé¦¬ä¸Šæœ‰éŒ¢èŠ±5å…¥",p:39},{n:"H10 æ›¸æ³•æ–°å¹´å¿«æ¨‚5å…¥",p:39},{n:"H11 æ›¸æ³•å¹³å®‰å–œæ¨‚5å…¥",p:39},{n:"H12 æ›¸æ³•å¤§å‰å¤§åˆ©5å…¥",p:39},{n:"H13 å¤šå·´èƒºæ°´æœç³»åˆ—6å…¥",p:49},{n:"H14 å¤šå·´èƒºå°é¦¬ç³»åˆ—6å…¥",p:49},{n:"H15 å¡—é´‰æ°´æœç³»åˆ—6å…¥",p:49},{n:"H16 å¡é€šæ°´æœç³»åˆ—6å…¥",p:49},{n:"H17 å¡é€šå°é¦¬ç³»åˆ—6å…¥",p:49},{n:"H18 ç²¾ç¥å°é¦¬ç³»åˆ—6å…¥",p:49},{n:"H19 è Ÿç­†å°æ–°ç³»åˆ—6å…¥",p:59},{n:"H20 ä¸‰éº—é·—ç³»åˆ—6å…¥",p:59}] }
    ];

    function init() {
        const area = document.getElementById('item-area'), nav = document.getElementById('navbar');
        inventory.forEach((cat, idx) => {
            const id = 'cat-' + idx;
            nav.innerHTML += `<div class="nav-btn" onclick="document.getElementById('${id}').scrollIntoView({behavior:'smooth'})">${cat.cat}</div>`;
            let h = `<div class="cat-title" id="${id}">${cat.cat}</div><div class="product-grid">`;
            cat.items.forEach(item => {
                h += `<div class="p-btn" onclick="addToCart('${item.n}', ${item.p})">
                        <span class="p-name">${item.n}</span>
                        <span class="p-price">$${item.p}</span>
                      </div>`;
            });
            area.innerHTML += h + `</div>`;
        });
        updateLogDisplay();
    }

    function addToCart(n, p) { cart.push({n, p}); renderCart(); }
    function renderCart() {
        const list = document.getElementById('cart-list');
        list.innerHTML = cart.map((item, i) => `
            <div class="row">
                <span style="flex:1; font-size:0.85em;">${item.n}</span>
                <span>$${item.p}</span>
                <span style="color:#ff4d4d; margin-left:10px; cursor:pointer;" onclick="cart.splice(${i},1);renderCart();">âœ•</span>
            </div>
        `).join('');
        calc();
    }

    function calc() {
        const total = cart.reduce((sum, i) => sum + i.p, 0);
        const disc = Number(document.getElementById('discount').value || 0);
        const finalTotal = Math.max(0, total - disc);
        document.getElementById('final-total').innerText = finalTotal;
        checkChange(); // é‡æ–°è¨ˆç®—ç¸½é¡æ™‚ä¹Ÿè¦æ›´æ–°æ‰¾é›¶
    }

    // æ–°å¢ï¼šè¨ˆç®—æ‰¾é›¶é‚æ
    function checkChange() {
        const finalTotal = Number(document.getElementById('final-total').innerText);
        const received = Number(document.getElementById('received').value || 0);
        const changeDisplay = document.getElementById('change-amount');
        
        if (received > 0) {
            const change = received - finalTotal;
            changeDisplay.innerText = "$" + change;
            changeDisplay.style.color = change < 0 ? "#d9534f" : "#2e7d32"; // éŒ¢ä¸å¤ è®Šç´…è‰²
        } else {
            changeDisplay.innerText = "$0";
            changeDisplay.style.color = "#2e7d32";
        }
    }

    function setPay(type) {
        payType = type;
        document.getElementById('btn-cash').className = 'm-btn' + (type==='ç¾é‡‘'?' active':'');
        document.getElementById('btn-card').className = 'm-btn' + (type==='é›»æ”¯'?' active':'');
    }

    function submit() {
        if(!cart.length) return;
        const total = Number(document.getElementById('final-total').innerText);
        const received = Number(document.getElementById('received').value || 0);
        
        // å¦‚æœæ˜¯ç¾é‡‘æ”¯ä»˜ä¸”è¼¸å…¥äº†æ”¶æ¬¾é‡‘é¡ï¼Œæª¢æŸ¥æ˜¯å¦è¶³å¤ 
        if(payType === 'ç¾é‡‘' && received > 0 && received < total) {
            if(!confirm("å¯¦æ”¶é‡‘é¡ä¸è¶³ï¼Œç¢ºå®šè¦çµå¸³å—ï¼Ÿ")) return;
        }

        const details = cart.map(i => i.n).join(', ');
        const now = new Date();
        const dateStr = now.toLocaleDateString();
        const timeStr = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

        orderHistory.unshift({ date: dateStr, time: timeStr, payType, total, details });
        localStorage.setItem('pos_history_v3', JSON.stringify(orderHistory));
        updateLogDisplay();

        // å‚³é€è‡³ Google
        const formData = new URLSearchParams();
        formData.append("entry.832550789", details + " (" + payType + ")");
        formData.append("entry.567851946", total);
        fetch("https://docs.google.com/forms/d/e/1FAIpQLSdX8Gk4YPPV05mSDKfL3gqSiXTZS8v47Qot180v0TgUpVbhQA/formResponse", { method: "POST", mode: "no-cors", body: formData });

        // æ¸…ç©ºæ¬„ä½
        cart = []; 
        document.getElementById('discount').value = ''; 
        document.getElementById('received').value = ''; // æ¸…ç©ºæ”¶æ¬¾
        document.getElementById('change-amount').innerText = '$0'; // æ¸…ç©ºæ‰¾é›¶
        renderCart();
        alert("çµå¸³æˆåŠŸï¼");
    }

    function updateLogDisplay() {
        const logArea = document.getElementById('order-log');
        if(!orderHistory.length) { logArea.innerHTML = "<p style='text-align:center; color:#ccc;'>æš«ç„¡ç´€éŒ„</p>"; return; }

        const groups = {};
        orderHistory.forEach(o => {
            if(!groups[o.date]) groups[o.date] = { orders: [], dayTotal: 0 };
            groups[o.date].orders.push(o);
            groups[o.date].dayTotal += o.total;
        });

        let html = '';
        for(let date in groups) {
            html += `<div class="date-group">
                <div class="date-header"><span>ğŸ“… ${date}</span><span>ç•¶æ—¥ç¸½é¡: $${groups[date].dayTotal}</span></div>`;
            groups[date].orders.forEach(o => {
                html += `<div class="log-item">
                    <div style="display:flex; justify-content:space-between; font-weight:bold;">
                        <span>${o.time} - ${o.payType}</span>
                        <span style="color:#d9534f;">$${o.total}</span>
                    </div>
                    <div class="log-details">${o.details}</div>
                </div>`;
            });
            html += `</div>`;
        }
        logArea.innerHTML = html;
    }

    init();
</script>
</body>
</html>
