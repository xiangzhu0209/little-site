<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ§¸ è§’è½é›œè²¨èˆ– POS (å®Œæ•´ç‰ˆ+åˆ†é¡ä¸‹æ‹‰é¸å–®+æ”¾å¤§)</title>
    <style>
        :root { --main-brown: #b0a496; --bg-cream: #fcf8f5; --accent-brown: #8c7b6c; --price-red: #d9534f; --profit-green: #6b8e23; }
        body { font-family: sans-serif; background: var(--bg-cream); margin: 0; display: flex; flex-direction: column; height: 100vh; color: #5d5246; overflow: hidden; }
        header { background: var(--main-brown); color: white; padding: 12px; text-align: center; font-size: 1.3em; font-weight: bold; flex-shrink: 0; }
        .nav-bar { background: #e8e0d9; padding: 10px; display: flex; gap: 10px; overflow-x: auto; border-bottom: 2px solid #d1c7bc; flex-shrink: 0; }
        .nav-btn { background: white; border: 1px solid #d1c7bc; padding: 8px 18px; border-radius: 20px; white-space: nowrap; cursor: pointer; font-size: 1.1em; }
        
        .main-content { display: flex; flex: 1; overflow: hidden; padding: 10px; gap: 10px; }
        .item-area { flex: 1.8; overflow-y: auto; background: white; border-radius: 15px; padding: 15px; border: 2px solid #e8e0d9; }
        .cat-title { background: #fdf5f0; padding: 8px 15px; border-radius: 20px; margin: 15px 0 8px; font-weight: bold; border-left: 8px solid var(--main-brown); font-size: 1.2em; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(135px, 1fr)); gap: 10px; }
        .p-btn { background: white; border: 1px solid #f0e6dd; border-radius: 12px; padding: 10px 5px; text-align: center; cursor: pointer; box-shadow: 2px 2px 0 #e8e0d9; min-height: 90px; display: flex; flex-direction: column; justify-content: center; }
        .p-name { font-size: 0.9em; font-weight: bold; margin-bottom: 5px; height: 2.4em; overflow: hidden; }
        .p-price { color: #c2966d; font-size: 1.2em; font-weight: bold; }
        .p-stock { font-size: 0.8em; color: #999; }

        .checkout-area { flex: 1; display: flex; flex-direction: column; gap: 10px; min-width: 320px; overflow-y: auto; }
        .card { background: white; border-radius: 15px; padding: 12px; border: 2px solid #e8e0d9; }
        #cart-list { max-height: 200px; overflow-y: auto; border-bottom: 2px dashed #e8e0d9; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; font-size: 1.1em; border-bottom: 1px solid #eee; }
        .big-input { font-size: 1.8em; padding: 12px; width: 100%; border-radius: 10px; border: 2px solid #d1c7bc; text-align: right; box-sizing: border-box; background: #fffcf5; font-weight: bold; }
        .total-display { font-size: 3.2em; font-weight: bold; color: var(--price-red); text-align: right; margin: 10px 0; }
        .pay-btn { flex: 1; padding: 15px; border-radius: 10px; border: 1px solid #ccc; background: white; cursor: pointer; font-weight: bold; font-size: 1.3em;}
        .pay-btn.active { background: var(--accent-brown); color: white; border-color: var(--accent-brown); }

        #admin-panel { position: fixed; inset: 5px; background: white; z-index: 1000; border-radius: 20px; display: none; flex-direction: column; padding: 15px; border: 3px solid var(--main-brown); box-shadow: 0 0 50px rgba(0,0,0,0.3); }
        .admin-layout { display: grid; grid-template-columns: 1.6fr 0.9fr; gap: 15px; flex: 1; overflow: hidden; }
        
        .add-row-top { background: #f0fdf4; padding: 20px; border: 2px solid var(--profit-green); border-radius: 15px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; margin-bottom: 15px; }
        .add-row-top div { display: flex; flex-direction: column; gap: 5px; }
        .add-row-top label { font-size: 1em; color: #444; font-weight: bold; }
        .add-row-top input, .add-row-top select { font-size: 1.3em; padding: 12px; border: 1px solid #ccc; border-radius: 8px; background: white; }
        .add-row-top button { font-size: 1.3em; padding: 15px 40px; background: var(--profit-green); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; align-self: flex-end; }

        .admin-table-container { overflow: auto; border: 1px solid #eee; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; font-size: 1.1em; }
        th { background: #f4f4f4; position: sticky; top: 0; padding: 12px; border: 1px solid #ddd; z-index: 5; }
        td { padding: 10px; border: 1px solid #ddd; text-align: center; }
        .admin-input { width: 70px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1.2em; text-align: center; }
        .move-btn { cursor: pointer; padding: 5px 15px; background: #eee; border-radius: 4px; border: 1px solid #ccc; font-weight: bold; font-size: 1.2em; margin: 0 2px; }
        .del-x { color: red; font-weight: bold; cursor: pointer; font-size: 1.5em; padding: 5px; }
    </style>
</head>
<body>

<header>ğŸ§¸ è§’è½é›œè²¨èˆ– POS (å®Œæ•´ç‰ˆ+å„ªåŒ–åˆ†é¡)</header>
<div class="nav-bar" id="navbar"></div>

<div class="main-content">
    <div class="item-area" id="item-area"></div>
    <div class="checkout-area">
        <div class="card">
            <strong>ğŸ›’ ç•¶å‰æ¸…å–®</strong>
            <div id="cart-list"></div>
            <div style="margin-top:10px;"><input type="number" id="discount" class="big-input" placeholder="æŠ˜æ‰£ (æ¸›åƒ¹)" oninput="calc()"></div>
            <div class="total-display">$<span id="final-total">0</span></div>
            <div style="display:flex; gap:8px; margin-bottom:10px;">
                <button class="pay-btn active" id="btn-cash" onclick="setPay('ç¾é‡‘')">ğŸ’µ ç¾é‡‘</button>
                <button class="pay-btn" id="btn-elec" onclick="setPay('é›»æ”¯')">ğŸ“± é›»æ”¯</button>
            </div>
            <input type="number" id="cash-in" class="big-input" placeholder="å¯¦æ”¶é‡‘é¡" oninput="calcChange()"> 
            <div style="text-align:right; margin-top:5px; font-size: 1.3em;">æ‰¾é›¶: <span id="cash-change" style="font-weight:bold; color:red; font-size:1.8em;">0</span></div>
            <button onclick="submitOrder()" style="width:100%; padding:20px; margin-top:15px; background:var(--profit-green); color:white; border:none; border-radius:15px; font-weight:bold; font-size:1.6em;">çµå¸³å®Œæˆ</button>
        </div>
        <div class="card" style="flex:1; font-size: 1em;" id="order-log"></div>
    </div>
</div>

<div style="padding:15px; text-align:center;">
    <button onclick="toggleAdmin()" style="padding:18px 40px; border-radius:15px; cursor:pointer; background:white; border:3px solid var(--main-brown); font-weight:bold; font-size: 1.3em;">ğŸ› ï¸ å•†å“ç·¨è¼¯ / æ”¶æ”¤çµ±è¨ˆ</button>
</div>

<div id="admin-panel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 10px;">
        <h2 style="margin:0;">âš™ï¸ å•†å“ç®¡ç†èˆ‡çµ±è¨ˆ</h2>
        <button onclick="toggleAdmin()" style="padding:10px 25px; font-size: 1.2em; border-radius: 8px;">âœ• é—œé–‰è¦–çª—</button>
    </div>

    <div class="add-row-top">
        <div>
            <label>é¸æ“‡åˆ†é¡</label>
            <select id="select-cat" style="width:200px;" onchange="checkNewCat(this.value)">
                </select>
        </div>
        <div><label>ç·¨è™Ÿ</label><input type="text" id="new-id" style="width:90px;" placeholder="ID"></div>
        <div><label>å“å</label><input type="text" id="new-n" style="width:220px;" placeholder="å•†å“åç¨±"></div>
        <div><label>æˆæœ¬</label><input type="number" id="new-c" style="width:90px;" placeholder="0"></div>
        <div><label>å”®åƒ¹</label><input type="number" id="new-p" style="width:90px;" placeholder="0"></div>
        <div><label>åº«å­˜</label><input type="number" id="new-s" style="width:90px;" placeholder="0"></div>
        <button onclick="addNewProduct()">â• æ–°å¢å“é …</button>
    </div>

    <div class="admin-layout">
        <div class="admin-table-container">
            <table>
                <thead><tr><th>ç§»å‹•</th><th>å“å</th><th>æˆæœ¬</th><th>å”®åƒ¹</th><th>åº«å­˜</th><th>åˆªé™¤</th></tr></thead>
                <tbody id="admin-tbody"></tbody>
            </table>
        </div>
        <div style="background:#f9f9f9; padding:20px; border-radius:15px; overflow-y:auto;">
            <h3 style="margin:0 0 10px 0;">ğŸ“Š ä»Šæ—¥çµ±è¨ˆ</h3>
            <div style="margin-bottom:15px;">ç‡Ÿæ”¶: <b id="stat-revenue" style="color:red; font-size:1.8em;">0</b> / åˆ©æ½¤: <b id="stat-profit" style="color:green; font-size:1.8em;">0</b></div>
            <table style="font-size:1em;">
                <thead><tr style="background:#eee;"><th>å“å</th><th>é‡</th><th>é¡</th></tr></thead>
                <tbody id="stat-tbody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // å®Œæ•´åŸå§‹æ¸…å–® (A-Hå€)
    const initialData = [
        { cat: "A åŒ…åŒ…å€", items: [ {id:"A01", n:"é‡ç¹”æ‰˜ç‰¹åŒ…(é»ƒé¬±é‡‘é¦™)", c:15, p:79, s:2}, {id:"A02", n:"é‡ç¹”æ‰˜ç‰¹åŒ…(ç±³è‰²å°ç™½ç‹—)", c:15, p:79, s:2}, {id:"A03", n:"æ³¢é»å°ç‹—åŒ–å¦åŒ…", c:30, p:99, s:2}, {id:"A04", n:"insè´è¶çµçšºè‚©åŒ…(éŠ€)", c:85, p:199, s:1}, {id:"A05", n:"Insè´è¶çµçšºè‚©åŒ…(è—)", c:85, p:199, s:1}, {id:"A06", n:"å¾©å¤æ‰‹æä¿é½¡çƒåŒ…(å’–)", c:100, p:249, s:1}, {id:"A07", n:"è±¹ç´‹æ‰‹æå°å»¢åŒ…(å’–)", c:80, p:149, s:1}, {id:"A08", n:"ç´ é¢æ–œè·¨çšºè‚©åŒ…", c:90, p:199, s:1}, {id:"A09", n:"ç´ é¢æ–œè‚©åŒ…(ç™½)", c:90, p:199, s:1}, {id:"A10", n:"æ³•å¼æœˆç‰™è…‹ä¸‹åŒ…(é»‘)", c:85, p:199, s:1}, {id:"A11", n:"æ³•å¼æœˆç‰™è…‹ä¸‹åŒ…(ç™½)", c:85, p:199, s:2}, {id:"A12", n:"é›²æœµè¿·ä½ æ‰‹æåŒ…(ç™½)", c:70, p:139, s:2}, {id:"A13", n:"é›²æœµè¿·ä½ æ‰‹æåŒ…(é»‘)", c:70, p:139, s:2}, {id:"A14", n:"å¾©å¤äº®çš®æ‰‹ææ–œè·¨åŒ…(é»‘)", c:140, p:249, s:1}, {id:"A15", n:"å°ç‹—æŠ˜ç–ŠåŒ–å¦åŒ…", c:55, p:100, s:8}, {id:"A16", n:"å¡å…¶è±¹ç´‹å°æ–¹åŒ…", c:55, p:139, s:1}, {id:"A17", n:"ç·¨ç¹”æœˆç‰™è…‹ä¸‹åŒ…(ç²‰ç´…)", c:95, p:199, s:1}, {id:"A18", n:"æ³•å¼è·³è‰²æœˆç‰™è…‹ä¸‹åŒ…(ç±³ç™½)", c:70, p:199, s:2}, {id:"A19", n:"Y2KéŠæ¢é›™è‚©åŒ…", c:90, p:199, s:1}, {id:"A20", n:"JKé¢¨æ—¥ç³»éƒµå·®åŒ…(å’–)", c:120, p:289, s:1}, {id:"A21", n:"æ¼†çš®æ³•æ£è…‹ä¸‹åŒ…(é»‘)", c:90, p:199, s:2}, {id:"A22", n:"çç é›™éŠæ¢è…‹ä¸‹åŒ…(ç²‰)", c:65, p:249, s:1}, {id:"A23", n:"çç é›™éˆæ¢è…‹ä¸‹åŒ…(ç™½)", c:65, p:249, s:1}, {id:"A24", n:"æ³•åœ‹å°çœ¾æ–¹å½¢è…‹ä¸‹åŒ…(é»‘)", c:60, p:199, s:2}, {id:"A25", n:"æ³•åœ‹å°çœ¾æ–¹å½¢è…‹ä¸‹åŒ…(ç´…æ£•)", c:60, p:199, s:2}, {id:"A26", n:"å¤§å®¹é‡ä¿é½¡çƒåŒ…(å’–)", c:80, p:289, s:1}, {id:"A27", n:"è•¾çµ²èŠ±é‚Šå¾ŒèƒŒåŒ…(é»‘)", c:70, p:199, s:1}, {id:"A28", n:"è•¾çµ²èŠ±é‚Šå¾ŒèƒŒåŒ…(ç²‰)", c:70, p:199, s:1}, {id:"A29", n:"éŸ“ç³»ç°¡ç´„è¤¶çšºé›²æœµåŒ…", c:65, p:199, s:1}, {id:"A30", n:"é‡ç¹”ææ‰‹åŒ…(çœ¼é¡ç‹—)", c:65, p:139, s:2}, {id:"A31", n:"é‡ç¹”ææ‰‹åŒ…(ç´…æ ¼ç‹—)", c:65, p:139, s:2} ]},
        { cat: "B ç”Ÿæ´»å°ç‰©", items: [ {id:"B01", n:"è¿·ä½ ç£å¸å°æª¯ç‡ˆ(è—)", c:30, p:79, s:3}, {id:"B02", n:"è¿·ä½ ç£å¸å°æª¯ç‡ˆ(ç¶ )", c:30, p:79, s:3}, {id:"B03", n:"ç« é­šæš–å…‰ç‡ˆ(è—)", c:40, p:89, s:2}, {id:"B04", n:"ç« é­šæš–å…‰ç‡ˆ(é»ƒ)", c:40, p:89, s:2}, {id:"B05", n:"é¬±é‡‘é¦™å°å£å¤¾(é»ƒ)", c:15, p:69, s:2}, {id:"B06", n:"é¬±é‡‘é¦™å°å£å¤¾(ç²‰)", c:15, p:69, s:2}, {id:"B07", n:"ä¸ƒå±¤æ¼¢å ¡å¡‘è† ç›¤", c:35, p:129, s:2}, {id:"B08", n:"é»ƒè‰²çœ¼ç›åŒ–å¦é¡", c:25, p:99, s:2}, {id:"B09", n:"ç²‰è‰²çœ¼ç›åŒ–å¦é¡", c:25, p:99, s:2}, {id:"B10", n:"ä¸™çƒ¯é¦¬å…‹ç­†(12è‰²)", c:40, p:99, s:2}, {id:"B11", n:"ä¸™çƒ¯é¦¬å…‹ç­†(48è‰²)", c:150, p:259, s:1}, {id:"B12", n:"ä¾¿åˆ©åº—å­˜éŒ¢ç½", c:85, p:159, s:1}, {id:"B13", n:"å»£è§’é¡æ‰‹æ©Ÿæ”¯æ¶", c:40, p:99, s:6}, {id:"B14", n:"å°éº¥éº¥è€³æ©Ÿå¸½", c:30, p:89, s:1}, {id:"B15", n:"å¤šå·´èƒºè¨ˆç®—æ©Ÿ(é»ƒ)", c:45, p:99, s:1}, {id:"B16", n:"å¤šå·´èƒºè¨ˆç®—æ©Ÿ(ç´«)", c:45, p:99, s:1}, {id:"B17", n:"å¤šå·´èƒºè¨ˆç®—æ©Ÿ(ç™½)", c:45, p:99, s:1}, {id:"B18", n:"é›²æœµé¡", c:15, p:49, s:1}, {id:"B19", n:"é…ªæ¢¨é¦™æ°›è Ÿç‡­", c:20, p:99, s:4}, {id:"B20", n:"æ©˜å­é¦™æ°›è Ÿç‡­", c:30, p:99, s:2}, {id:"B21", n:"è–èª•æ¨¹è Ÿç‡­(ç™½)", c:35, p:99, s:2}, {id:"B22", n:"è–èª•æ¨¹è Ÿç‡­(ç¶ )", c:35, p:99, s:2}, {id:"B23", n:"æŸ¿å­é¦™æ°›è Ÿç‡­", c:45, p:99, s:4}, {id:"B24", n:"å±±ç«¹é¦™æ°›è Ÿç‡­", c:45, p:99, s:4}, {id:"B25", n:"æ˜Ÿæ˜Ÿäººæ‰‹æ©Ÿæ°£å›Š(æ‘”)", c:10, p:59, s:2}, {id:"B26", n:"æ˜Ÿæ˜Ÿäººæ‰‹æ©Ÿæ°£å›Š(çœ‹)", c:10, p:59, s:2}, {id:"B27", n:"ç„¡å°¾ç†Šç£å¸æ°£å›Š", c:28, p:79, s:2}, {id:"B28", n:"æ‰‹ææŠ±æ•æ¯¯(é¤…ä¹¾)", c:135, p:249, s:1}, {id:"B29", n:"æ‰‹ææŠ±æ•æ¯¯(å·§å…‹åŠ›)", c:135, p:249, s:1}, {id:"B30", n:"èƒ¡è˜¿è””éŒ„éŸ³ç­†", c:30, p:69, s:4}, {id:"B31", n:"å¯é Œæ›å‹¾", c:65, p:99, s:8} ]},
        { cat: "C ç¹”å“å€", items: [ {id:"C01", n:"é›¨å‚˜æ“¦æ‰‹å·¾", c:20, p:79, s:1}, {id:"C02", n:"ç´…è‰²è˜‘è‡æ‰‹å·¾", c:21, p:79, s:2}, {id:"C03", n:"è—å¸½å­å°ç‹—æ‰‹å·¾", c:33, p:99, s:2}, {id:"C04", n:"éº¥ç•¶è²“æ“¦æ‰‹å·¾", c:38, p:99, s:1}, {id:"C05", n:"æµ·æ˜Ÿæ“¦æ‰‹å·¾", c:33, p:99, s:2}, {id:"C06", n:"æ°´æ¯æ“¦æ‰‹å·¾", c:33, p:99, s:2}, {id:"C07", n:"åŠ å¤§å¯æ„›ç‹—æ‰‹å·¾", c:33, p:129, s:2}, {id:"C08", n:"åŠ å¤§å¯æ„›ç†Šæ‰‹å·¾", c:33, p:129, s:1}, {id:"C09", n:"åŠ å¤§å¯æ„›è±¬æ‰‹å·¾", c:33, p:129, s:1}, {id:"C10", n:"å’–å•¡å°ç‹—æ“¦æ‰‹å·¾", c:15, p:99, s:2}, {id:"C11", n:"éºµåŒ…ç‹—æ‰‹å·¾", c:18, p:99, s:1}, {id:"C12", n:"è¢‹å­ç‹—æ‰‹å·¾", c:18, p:99, s:2}, {id:"C13", n:"èƒŒåŒ…ç‹—æ‰‹å·¾", c:18, p:99, s:2}, {id:"C14", n:"ç·šæ¢ç‹—æ‰‹å·¾", c:30, p:99, s:1}, {id:"C16", n:"æ´‹è”¥å°ç‹—æ‰‹å·¾", c:20, p:99, s:1}, {id:"C17", n:"æ©˜å­å°ç‹—æ‰‹å·¾", c:20, p:99, s:2}, {id:"C18", n:"åèˆŒé ­ç²‰ç´…ç‹—", c:22, p:99, s:2}, {id:"C19", n:"å¸½å­é•·è€³ç‹—", c:22, p:99, s:2} ]},
        { cat: "D é«®é£¾é¤¨", items: [ {id:"D01", n:"ç£¨ç ‚æ¨¹è„‚ç„¡ç—•å¤¾(é»‘)", c:20, p:49, s:2}, {id:"D02", n:"ç£¨ç ‚æ¨¹è„‚ç„¡ç—•å¤¾(ç™½)", c:20, p:49, s:2}, {id:"D03", n:"æ³¢ç´‹å¥¶ç³–é¯Šé­šå¤¾", c:30, p:69, s:1}, {id:"D04", n:"èŠ±é‚Šå°é«®åœˆ(é»‘)", c:10, p:29, s:3}, {id:"D05", n:"å¸ƒé¢è±¹ç´‹ç„¡ç—•å¤¾", c:30, p:69, s:1}, {id:"D06", n:"è—è‰²æ ¼å­æ«»æ¡ƒèŠ±æœµåœ–", c:35, p:79, s:1}, {id:"D07", n:"è—è‰²æ«»æ¡ƒæ¢ç´‹å¤§è…¸åœˆ", c:30, p:69, s:1}, {id:"D08", n:"æ¯›æ¯›é¯Šé­šå¤¾(æ·ºå’–)", c:25, p:69, s:1}, {id:"D09", n:"æ¯›æ¯›é¯Šé­šå¤¾(æ·±æ£•)", c:25, p:69, s:1}, {id:"D10", n:"æ„›å¿ƒé‘½ç„¡ç—•å¤¾", c:45, p:69, s:1}, {id:"D11", n:"çµ¨é¢æ„›å¿ƒæ°´æ»´bbå¤¾(ç™½)", c:33, p:69, s:1}, {id:"D12", n:"çµ¨é¢æ„›å¿ƒæ°´æ»´bbå¤¾(è±¹ç´‹)", c:33, p:69, s:1}, {id:"D13", n:"è´è¶çµæ ¼å­å°å¤¾", c:22, p:69, s:3}, {id:"D14", n:"å¸ƒé¢è±¹ç´‹èŠ±è‹åœˆ", c:36, p:79, s:1}, {id:"D15", n:"ç´…é‚Šç°é«®åœˆ", c:35, p:79, s:1}, {id:"D16", n:"è—æ¢ç´‹å¥¶æ²¹èŠ±é‚Šå¤§è…¸åœˆ", c:30, p:79, s:1}, {id:"D17", n:"è±ç´‹å’–è‰²ç„¡ç—•å¤¾", c:18, p:49, s:1}, {id:"D18", n:"ç™½è‰²æ°´æ³¢ç´‹ç„¡ç—•å¤¾", c:18, p:49, s:1}, {id:"D19", n:"æ©¢åœ“è´è¶çµå¤¾(éŠ€)", c:28, p:69, s:1}, {id:"D20", n:"æ©¢åœ“è´è¶çµå¤¾(ç™½)", c:28, p:69, s:1}, {id:"D21", n:"å¤§è™Ÿè±¹ç´‹é¯Šé­šå¤¾(å’–)", c:25, p:69, s:2}, {id:"D22", n:"é†‹é…¸é‡‘æ¨™ç„¡ç—•å¤¾(é»‘)", c:35, p:79, s:1}, {id:"D23", n:"é†‹é…¸é‡‘æ¨™ç„¡ç—•å¤¾(ç™½)", c:35, p:79, s:1}, {id:"D24", n:"çç è´è¶çµç„¡ç—•å¤¾(éŠ€)", c:30, p:79, s:2}, {id:"D25", n:"éŸ“ç³»é»‘é‚Šæ–œç´‹èŠ±é‚Š", c:35, p:79, s:1}, {id:"D26", n:"æ ¼ç´‹æ‰‡å½¢é¯Šé­šå¤¾", c:35, p:79, s:2}, {id:"D27", n:"é»‘é‚Šæ ¼ç´‹æ”¶è…°åœˆ", c:25, p:69, s:1}, {id:"D28", n:"è´è¶çµå’–è‰²æ ¼ç´‹ä¸‰ç¯€åœˆ", c:28, p:79, s:1}, {id:"D29", n:"æ˜¥å¤©è‰²è•¾çµ²å¤§è…¸åœˆ", c:25, p:79, s:1}, {id:"D30", n:"æ˜¥å¤©è‰²æ°´æ»´bbå¤¾", c:28, p:69, s:1}, {id:"D31", n:"å½ˆåŠ›é«®åœˆç½è£(å¥¶å’–)", c:10, p:49, s:2}, {id:"D32", n:"å½ˆåŠ›é«®åœˆç½è£(é»‘è‰²)", c:10, p:49, s:2}, {id:"D33", n:"æ°´æ»´BBå¤¾(10å…¥)", c:5, p:29, s:8}, {id:"D34", n:"å¤§è™Ÿè±¹ç´‹é¯Šé­šå¤¾(ç°)", c:25, p:69, s:2}, {id:"D35", n:"çç æ«»æ¡ƒç„¡ç—•å¤¾", c:30, p:79, s:3}, {id:"D36", n:"æ ¼ç´‹æ«»æ¡ƒç„¡ç—•å¤¾", c:25, p:69, s:1}, {id:"D37", n:"ç´ å’–+è±¹ç´‹(æ©¢åœ“å¤¾)", c:25, p:59, s:1}, {id:"D38", n:"ç´ å’–+è±¹ç´‹(æ°´æ»´å¤¾)", c:25, p:59, s:1}, {id:"D39", n:"ç´ å’–+è±¹ç´‹(æ„›å¿ƒå¤¾)", c:25, p:59, s:1} ]},
        { cat: "E å¨ƒå¨ƒ/æ›ä»¶", items: [ {id:"E01", n:"ç•«å®¶è¥¿é«˜åœ°(å’–)", c:60, p:99, s:2}, {id:"E02", n:"ç•«å®¶è¥¿é«˜åœ°(è—)", c:60, p:99, s:1}, {id:"E03", n:"ç•«å®¶è¥¿é«˜åœ°(ç´…)", c:60, p:99, s:1}, {id:"E04", n:"ç•«å®¶è¥¿é«˜åœ°(ç²‰)", c:60, p:99, s:1}, {id:"E05", n:"ç™½é›ªå…¬ä¸»è£æ‰®è¥¿é«˜åœ°", c:75, p:129, s:2}, {id:"E06", n:"å°é¦™é¢¨è£…æ‰®è¥¿é«˜åœ°", c:75, p:129, s:1}, {id:"E07", n:"èƒ¡è˜¿è””è£æ‰®è¥¿é«˜åœ°", c:73, p:129, s:11}, {id:"E08", n:"ææ€ªé•·æ¯›å°æ€ªç¸(ç²‰)", c:90, p:199, s:1}, {id:"E09", n:"ææ€ªé•·æ¯›å°æ€ªç¸(ç´«)", c:90, p:199, s:1}, {id:"E10", n:"éº¥ç•¶è²“å”å”å°æ›ä»¶", c:12, p:39, s:3}, {id:"E11", n:"éº¥ç•¶è²“å°æ›ä»¶", c:12, p:39, s:3}, {id:"E12", n:"åœ“é»å°ç‹—å°æ›ä»¶", c:15, p:49, s:3}, {id:"E13", n:"é¬±é‡‘é¦™æ›ä»¶(é»ƒ)", c:12, p:39, s:3}, {id:"E15", n:"é¬±é‡‘é¦™æ›ä»¶(ç²‰)", c:12, p:39, s:3}, {id:"E16", n:"ææ€ªé†œèŒèŠ±æœµ", c:13, p:49, s:5}, {id:"E17", n:"è£æ‰®æ€•æ´½ç‹—", c:38, p:79, s:3}, {id:"E18", n:"è–‘é¤…äººæ›ä»¶", c:15, p:39, s:2}, {id:"E19", n:"è–èª•æ¨¹æ›ä»¶", c:15, p:39, s:3}, {id:"E20", n:"åƒé‡Œçœ¼å°å¼·", c:10, p:39, s:2}, {id:"E21", n:"å¢¨é¡å°å¼·", c:10, p:39, s:1}, {id:"E22", n:"æŠ½æ‹‰å…”å­(è—)", c:60, p:129, s:2}, {id:"E23", n:"æŠ½æ‹‰å…”å­(é»ƒ)", c:60, p:129, s:1}, {id:"E24", n:"ä¸€æ¢ç‹—", c:42, p:99, s:5} ]},
        { cat: "F æœé£¾é…ä»¶", items: [ {id:"F01", n:"æ„›å¿ƒå…”å­ä¸­ç­’è¥ª", c:20, p:59, s:2}, {id:"F02", n:"ç´…å¸½å°ç‹—ä¸­ç­’è¥ª", c:18, p:59, s:1}, {id:"F03", n:"ç«‹é«”è²“å’ªè›‹è›‹è¥ª", c:10, p:49, s:3}, {id:"F04", n:"æ³¢é»å°ç‹—é•·ç­’è¥ª", c:8, p:49, s:2}, {id:"F05", n:"EGGåˆºç¹¡éº»èŠ±ä¸­ç­’è¥ª", c:25, p:69, s:2}, {id:"F06", n:"åˆºç¹¡ä¸­ç­’è¥ª(è´è¶çµç‹—)", c:25, p:69, s:2}, {id:"F07", n:"åŠ åšåŠ çµ¨é•·è¥ª(è‡˜è…¸ç‹—)", c:20, p:59, s:2}, {id:"F08", n:"æ³¢é»èŠ±é‚Šé•·ç­’(æ·±å’–)", c:25, p:69, s:2}, {id:"F09", n:"æ³¢é»èŠ±é‚Šé•·ç­’(å¥¶æ²¹ç™½)", c:25, p:69, s:2}, {id:"F10", n:"çŠç‘šçµ¨æŒé–€ç‹—(ç™½è—)", c:27, p:69, s:2}, {id:"F11", n:"çŠç‘šçµ¨æŒé–€ç‹—(ç™½å’–)", c:27, p:69, s:1}, {id:"F12", n:"è—è‰²è´è¶çµä¸­ç­’è¥ª", c:25, p:69, s:2}, {id:"F13", n:"ç¾Šæ¯›åˆºç¹¡å †å †è¥ª(å¸½å­ç‹—)", c:25, p:69, s:4}, {id:"F14", n:"ç²‰è‰²å…”å­ä¸­ç­’è¥ª", c:23, p:59, s:2}, {id:"F15", n:"é»é»ç´—ä¸­ç­’è¥ª", c:23, p:59, s:2}, {id:"F16", n:"é£›æ©Ÿç‹—éš±å½¢è¥ª(æ·±ç°)", c:20, p:49, s:2}, {id:"F17", n:"é£›æ©Ÿç‹—éš±å½¢è¥ª(å¥¶ç™½)", c:20, p:49, s:2}, {id:"F18", n:"é£›æ©Ÿç‹—éš±å½¢è¥ª(ç±³è‰²)", c:20, p:49, s:2}, {id:"F19", n:"è™æ›¸æ¬£åŒæ¬¾åœå·¾", c:70, p:199, s:2}, {id:"F20", n:"å››è‰²å’–å•¡è‰²æ ¼å­åœå·¾", c:75, p:199, s:2}, {id:"F21", n:"å¤§ç´…è˜‹æœåœå·¾", c:65, p:199, s:1}, {id:"F22", n:"ä»¿ç¾Šæ¯›å’–å•¡æ ¼åœå·¾", c:85, p:239, s:2}, {id:"F23", n:"ä»¿ç¾Šæ¯›è±¹ç´‹åœå·¾", c:80, p:239, s:2} ]},
        { cat: "G å±…å®¶é¤å»š", items: [ {id:"G01", n:"316ä¸é½é‹¼å†°å£©æ¯600ml", c:130, p:239, s:3}, {id:"G02", n:"æœ¨æŸ„æ¹¯åŒ™+å‰å­çµ„", c:55, p:99, s:2}, {id:"G03", n:"é´¨é´¨æ¹¯åŒ™+å‰å­çµ„", c:50, p:99, s:3}, {id:"G04", n:"çç æ¹¯åŒ™+å‰å­çµ„", c:55, p:99, s:5}, {id:"G05", n:"å¥¶é…ªæ¹¯åŒ™+å‰å­çµ„", c:58, p:99, s:4}, {id:"G06", n:"å¡çš®å·´æ‹‰åˆé‡‘ç­·(å¤ªé™½èŠ±)", c:25, p:59, s:5}, {id:"G07", n:"å¡çš®å·´æ‹‰åˆé‡‘ç­·(é’æ¢¨)", c:25, p:59, s:5}, {id:"G08", n:"å¯å¯è±†8.5å‹è‰å¸½ç›¤", c:128, p:239, s:2}, {id:"G09", n:"6.5å¯¸å¿ƒå‹ç¢—", c:75, p:159, s:2}, {id:"G10", n:"6å‹ç”œå“ç¢Ÿ(å¿«æ¨‚å°ç‹—)", c:57, p:139, s:3}, {id:"G11", n:"5.5å‹æ¨¹å±‹ç¢—", c:85, p:189, s:1}, {id:"G12", n:"8å‹è–¯æ¢ç›¤", c:40, p:99, s:2}, {id:"G13", n:"å°ç‹—é€ å‹ç›¤", c:50, p:129, s:2}, {id:"G14", n:"å°ç†Šé€ å‹ç›¤", c:50, p:129, s:2}, {id:"G15", n:"å¥¶é…ªé†¬æ–™ç¢Ÿ", c:30, p:49, s:2}, {id:"G16", n:"åå¸é€ å‹ç›¤", c:105, p:189, s:2}, {id:"G17", n:"æ³•æ£é€ å‹ç›¤", c:105, p:189, s:2}, {id:"G18", n:"åœå·¾å°ç‹—é¦¬å…‹æ¯", c:45, p:99, s:1}, {id:"G19", n:"åœå·¾å°è²“é¦¬å…‹æ¯", c:45, p:99, s:1}, {id:"G20", n:"è¸©æ°´å°ç‹—ç¢Ÿç¢Ÿæ¯", c:50, p:129, s:2}, {id:"G21", n:"è˜‹æœå°ç‹—ç¢Ÿç¢Ÿæ¯", c:50, p:129, s:2}, {id:"G22", n:"å¸ç®¡é¦¬å…‹æ¯(æ£•å¥³å­©)", c:70, p:159, s:2}, {id:"G23", n:"å¸ç®¡é¦¬å…‹æ¯(æ³¢é»ç‹—)", c:70, p:159, s:2}, {id:"G24", n:"å¸ç®¡é¦¬å…‹æ¯(æ³¢é»è±¡)", c:70, p:159, s:1}, {id:"G25", n:"å¸ç®¡é¦¬å…‹æ¯(æ£•ç”·å­©)", c:75, p:159, s:2}, {id:"G26", n:"å¸ç®¡é¦¬å…‹æ¯(æ³¢é»è²“)", c:75, p:159, s:2}, {id:"G27", n:"å¸ç®¡é¦¬å…‹æ¯(å¡—é´‰å…”)", c:74, p:159, s:2}, {id:"G28", n:"9å‹ç é‚Šæ·±ç›¤(ç¶ )", c:95, p:179, s:2}, {id:"G29", n:"æµ·æ´¾ç”œå¿ƒ9å‹æ·±ç›¤", c:111, p:189, s:2}, {id:"G30", n:"å°ç¾Š8å‹åœ“ç›¤", c:53, p:139, s:2}, {id:"G31", n:"å°ç‹—é†¬æ–™è¶(æ£•)", c:36, p:79, s:2}, {id:"G32", n:"å°ç‹—é†¬æ–™è¶(ç™½)", c:36, p:79, s:2}, {id:"G33", n:"å–æ°´é´¨é†¬æ–™ç¢Ÿ", c:26, p:79, s:2}, {id:"G34", n:"å¾©å¤å’–å•¡æ¯ç¢Ÿçµ„", c:136, p:239, s:2}, {id:"G35", n:"ç›´æ¢å¸ç®¡æ¯(æ£•å¥—)", c:43, p:99, s:2}, {id:"G36", n:"ç›´æ¢å¸ç®¡æ¯(ç¶ å¥—)", c:43, p:99, s:2} ]},
        { cat: "H ç¯€æ…¶æ–‡å…·", items: [ {id:"H1", n:"é¦¬å¹´å¤§å‰ç´…åŒ…(5å…¥)", c:6, p:39, s:5}, {id:"H2", n:"è²¡æºå»£é€²ç´…åŒ…(5å…¥)", c:6, p:39, s:5}, {id:"H3", n:"å¡é€šè˜‹æœç¦ç´…åŒ…(5å…¥)", c:6, p:39, s:5}, {id:"H4", n:"ç‡™é‡‘éº»å°‡é¦¬ç´…åŒ…(5å…¥)", c:7, p:39, s:5}, {id:"H5", n:"ç‡™é‡‘é¦¬ä¸Šæœ‰éŒ¢(5å…¥)", c:7, p:39, s:5}, {id:"H6", n:"ç‡™é‡‘æ»¿ç‰ˆé¦¬(5å…¥)", c:7, p:39, s:5}, {id:"H7", n:"Qç‰ˆé–‹é–‹å¿ƒå¿ƒ(5å…¥)", c:6, p:39, s:5}, {id:"H8", n:"Qç‰ˆé¦¬åŠ›å…¨é–‹(5å…¥)", c:6, p:39, s:5}, {id:"H9", n:"Qç‰ˆé¦¬ä¸ŠéŒ¢èŠ±(5å…¥)", c:6, p:39, s:5}, {id:"H10", n:"æ›¸æ³•æ–°å¹´å¿«æ¨‚(5å…¥)", c:8, p:39, s:2}, {id:"H11", n:"æ›¸æ³•å¹³å®‰å–œæ¨‚(5å…¥)", c:8, p:39, s:2}, {id:"H12", n:"æ›¸æ³•å¤§å‰å¤§åˆ©(5å…¥)", c:8, p:39, s:2}, {id:"H13", n:"å¤šå·´èƒºæ°´æœ(6å…¥)", c:8, p:49, s:3}, {id:"H14", n:"å¤šå·´èƒºå°é¦¬(6å…¥)", c:9, p:49, s:2}, {id:"H15", n:"å¡—é´‰æ°´æœç³»åˆ—(6å…¥)", c:6, p:49, s:2}, {id:"H16", n:"å¡é€šæ°´æœç³»åˆ—(6å…¥)", c:9, p:49, s:3}, {id:"H17", n:"å¡é€šå°é¦¬ç³»åˆ—(6å…¥)", c:9, p:49, s:3}, {id:"H18", n:"ç²¾ç¥å°é¦¬ç³»åˆ—(6å…¥)", c:13, p:49, s:3}, {id:"H19", n:"è Ÿç­†å°æ–°ç³»åˆ—(6å…¥)", c:22, p:59, s:2}, {id:"H20", n:"ä¸‰éº—é·—ç³»åˆ—(6å…¥)", c:22, p:59, s:2} ]}
    ];

    let inv = JSON.parse(localStorage.getItem('pos_inv_final')) || initialData;
    let orders = JSON.parse(localStorage.getItem('pos_orders_final')) || [];
    let cart = [];
    let currentPay = 'ç¾é‡‘';

    function init() {
        const area = document.getElementById('item-area'), nav = document.getElementById('navbar');
        area.innerHTML = ''; nav.innerHTML = '';
        inv.forEach((cat, idx) => {
            const showItems = cat.items.filter(it => it.s > 0);
            if (showItems.length === 0) return; 

            nav.innerHTML += `<div class="nav-btn" onclick="document.getElementById('c${idx}').scrollIntoView()">${cat.cat}</div>`;
            let gridHtml = `<div class="cat-title" id="c${idx}">${cat.cat}</div><div class="product-grid">`;
            showItems.forEach(it => { 
                gridHtml += `<div class="p-btn" onclick="addCart('${it.id}')"><div class="p-name">${it.id} ${it.n}</div><div class="p-price">$${it.p}</div><div class="p-stock">å­˜:${it.s}</div></div>`;
            });
            area.innerHTML += gridHtml + '</div>';
        });
        updateLog();
        updateCatSelect(); 
    }

    // æ›´æ–°åˆ†é¡ä¸‹æ‹‰é¸å–®
    function updateCatSelect() {
        const select = document.getElementById('select-cat');
        if(!select) return;
        let options = inv.map(c => `<option value="${c.cat}">${c.cat}</option>`).join('');
        options += `<option value="ADD_NEW_CAT">â• æ–°å¢æ–°åˆ†é¡...</option>`;
        select.innerHTML = options;
    }

    function checkNewCat(val) {
        if (val === "ADD_NEW_CAT") {
            const newName = prompt("è«‹è¼¸å…¥æ–°åˆ†é¡åç¨±ï¼š");
            if (newName && newName.trim() !== "") {
                if (!inv.find(c => c.cat === newName)) {
                    inv.push({cat: newName, items: []});
                    save();
                    updateCatSelect();
                    document.getElementById('select-cat').value = newName;
                } else {
                    alert("æ­¤åˆ†é¡å·²å­˜åœ¨ï¼");
                    document.getElementById('select-cat').selectedIndex = 0;
                }
            } else {
                document.getElementById('select-cat').selectedIndex = 0;
            }
        }
    }

    function addCart(id) {
        let target = null;
        inv.forEach(c => c.items.forEach(i => { if(i.id === id) target = i; }));
        if(target && target.s > 0) { cart.push({...target}); renderCart(); }
    }

    function renderCart() {
        document.getElementById('cart-list').innerHTML = cart.map((it, i) => `<div class="cart-item"><span>${it.id} ${it.n}</span><b>$${it.p}</b><span onclick="cart.splice(${i},1);renderCart()" style="color:red; cursor:pointer;">âœ•</span></div>`).join('');
        calc();
    }

    function calc() {
        const total = cart.reduce((a,b)=>a+b.p, 0) - Number(document.getElementById('discount').value || 0);
        document.getElementById('final-total').innerText = Math.max(0, total);
        calcChange();
    }

    function calcChange() {
        const t = Number(document.getElementById('final-total').innerText), p = Number(document.getElementById('cash-in').value || 0);
        document.getElementById('cash-change').innerText = p > t ? p - t : 0;
    }

    function setPay(m) {
        currentPay = m;
        document.getElementById('btn-cash').className = m==='ç¾é‡‘'?'pay-btn active':'pay-btn';
        document.getElementById('btn-elec').className = m==='é›»æ”¯'?'pay-btn active':'pay-btn';
    }

    function submitOrder() {
        if(!cart.length) return;
        const total = Number(document.getElementById('final-total').innerText), cost = cart.reduce((a,b)=>a+(b.c||0), 0);
        cart.forEach(item => { inv.forEach(cat => cat.items.forEach(it => { if(it.id === item.id) it.s--; })); });
        orders.unshift({ id: Date.now(), t: new Date().toLocaleTimeString(), d: new Date().toLocaleDateString(), total, profit: total-cost, items: [...cart] });
        cart = []; document.getElementById('discount').value = ''; document.getElementById('cash-in').value = '';
        save(); init(); alert("çµå¸³æˆåŠŸï¼");
    }

    function updateLog() {
        const today = new Date().toLocaleDateString(), tOrders = orders.filter(o => o.d === today);
        document.getElementById('stat-revenue').innerText = tOrders.reduce((a,b)=>a+b.total, 0);
        document.getElementById('stat-profit').innerText = tOrders.reduce((a,b)=>a+b.profit, 0);
        document.getElementById('order-log').innerHTML = "<strong>ğŸ“‹ æœ€è¿‘äº¤æ˜“</strong><hr>" + orders.slice(0,5).map(o => `<div style="padding:5px; border-bottom:1px solid #eee;">$${o.total} (${o.t}) <span style="color:red; float:right;" onclick="deleteOrder(${o.id})">âœ•</span></div>`).join('');
    }

    function deleteOrder(oid) { if(confirm("åˆªé™¤é€™ç­†äº¤æ˜“ä¸¦é‚„åŸåº«å­˜ï¼Ÿ")) { orders = orders.filter(o => o.id !== oid); save(); init(); } }

    function toggleAdmin() {
        const p = document.getElementById('admin-panel');
        p.style.display = p.style.display === 'flex' ? 'none' : 'flex';
        if(p.style.display === 'flex') { renderAdminTable(); renderStatTable(); updateCatSelect(); } else { init(); }
    }

    function renderAdminTable() {
        let html = '';
        inv.forEach((cat, ci) => {
            html += `<tr style="background:#f4f4f4;"><td colspan="6" style="text-align:left; padding-left:10px;"><b>${cat.cat}</b></td></tr>`;
            cat.items.forEach((it, ii) => { 
                html += `<tr>
                    <td><span class="move-btn" onclick="move(${ci},${ii},-1)">â†‘</span><span class="move-btn" onclick="move(${ci},${ii},1)">â†“</span></td>
                    <td style="text-align:left;">${it.id} ${it.n}</td>
                    <td><input type="number" class="admin-input" value="${it.c}" onchange="edit(${ci},${ii},'c',this.value)"></td>
                    <td><input type="number" class="admin-input" value="${it.p}" onchange="edit(${ci},${ii},'p',this.value)"></td>
                    <td><input type="number" class="admin-input" value="${it.s}" onchange="edit(${ci},${ii},'s',this.value)"></td>
                    <td><span class="del-x" onclick="delP(${ci},${ii})">ğŸ—‘ï¸</span></td>
                </tr>`; 
            });
        });
        document.getElementById('admin-tbody').innerHTML = html;
    }

    function addNewProduct() {
        const catN = document.getElementById('select-cat').value;
        const id = document.getElementById('new-id').value;
        const n = document.getElementById('new-n').value;
        const c = Number(document.getElementById('new-c').value);
        const p = Number(document.getElementById('new-p').value);
        const s = Number(document.getElementById('new-s').value);
        
        if(!catN || !n) return alert("è«‹é¸åˆ†é¡ä¸¦å¡«å“å");
        
        let cat = inv.find(v => v.cat === catN);
        cat.items.push({id, n, c, p, s});
        
        save(); renderAdminTable();
        ['new-id','new-n','new-c','new-p','new-s'].forEach(fid => document.getElementById(fid).value = '');
    }

    function move(ci, ii, dir) {
        let items = inv[ci].items;
        if(ii+dir < 0 || ii+dir >= items.length) return;
        [items[ii], items[ii+dir]] = [items[ii+dir], items[ii]];
        save(); renderAdminTable();
    }
    function edit(ci, ii, k, v) { inv[ci].items[ii][k] = Number(v); save(); }
    function delP(ci, ii) { if(confirm("åˆªé™¤å“é …ï¼Ÿ")) { inv[ci].items.splice(ii, 1); save(); renderAdminTable(); } }
    function save() { localStorage.setItem('pos_inv_final', JSON.stringify(inv)); localStorage.setItem('pos_orders_final', JSON.stringify(orders)); }

    function renderStatTable() {
        const summary = {};
        orders.filter(o => o.d === new Date().toLocaleDateString()).forEach(o => {
            o.items.forEach(it => { if(!summary[it.n]) summary[it.n] = {count:0, total:0}; summary[it.n].count++; summary[it.n].total+=it.p; });
        });
        let html = '';
        for(let n in summary) html += `<tr><td style="text-align:left;">${n}</td><td>${summary[n].count}</td><td>$${summary[n].total}</td></tr>`;
        document.getElementById('stat-tbody').innerHTML = html || '<tr><td colspan="3">å°šç„¡éŠ·å”®</td></tr>';
    }

    init();
</script>
</body>
</html>
